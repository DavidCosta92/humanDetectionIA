import math

# crear clase que sea rastreador
class Rastreador:
    # --- init variables
    def __init__(self):
        #almacenado de posiciones centrales de los objetos
        self.centro_puntos = {}
        #Contador de objetos
        self.id_count = 0

    def rastreo(self, objetos):
        #almacenar obj identificados
        objetos_id = []

        # Obtener el punto central del nuevo objeto
        for rect in objetos:
            x ,y , w , h = rect
            cx = (x +x +w)//2
            cy = (y +y +h)//2

            # chequear si el obj ya fue detectado antes
            objeto_det = False
            for id , pt in self.centro_puntos.items():
                dist = math.hypot(cx - pt[0], cy - pt[1])
                print("---------------------------------------------------------- dist" +str(dist))
                if dist < 250:
                    self.centro_puntos[id] = (cx,cy)
                    objetos_id.append([x,y,w,h,id])
                    objeto_det = True
                    break

            #Si detecta un nuevo objeto le asignamos el ID a ese objeto
            if objeto_det is False:
                self.centro_puntos[self.id_count] = (cx , cy) # almacena la cordenada x e y
                objetos_id.append([x,y,w,h,self.id_count]) # agregamos el id del nuevo objeto a la lista
                self.id_count += 1


        print("---------objetos_id" +str(objetos_id))

        #Limpiar lista por puntos centrales para eliminar IDS que ya no se usan
        new_center_points = {}
        for obj_bb_id in objetos_id:
            _,_,_,_,object_id = obj_bb_id
            center = self.centro_puntos[object_id]
            new_center_points[object_id] = center

        #Actualizar la lista con los id no usados que fueron eliminados

        # self.centro_puntos = new_center_points.copy()
        return objetos_id

"""
[288, 399, 773, 223]
[288, 399, 773, 223, 0]

[266, 227, 390, 791]
[266, 227, 390, 791, 1]

[391, 228, 276, 783]
[391, 228, 276, 783, 2]

[257, 393, 227, 798]
[257, 393, 227, 798, 3]

[240, 817, 396, 223]
[240, 817, 396, 223, 4]

[817, 242, 396, 223]
[817, 242, 396, 223, 5]
[816, 245, 397, 223]
[816, 245, 397, 223, 5]

[224, 380, 242, 820]
[224, 380, 242, 820, 6]

[224, 242, 820, 383]
[224, 242, 820, 383, 7]

[826, 234, 228, 387]
[826, 234, 228, 387, 8]

[832, 233, 411, 207]
[832, 233, 411, 207, 9]
[832, 233, 413, 206]
[832, 233, 413, 206, 9]

[832, 234, 211, 407]
[832, 234, 211, 407, 10]

[202, 420, 844, 237]
[202, 420, 844, 237, 11]

[201, 844, 237, 421]
[201, 844, 237, 421, 12]

[242, 450, 178, 843]
[242, 450, 178, 843, 13]

[432, 194, 250, 846]
[432, 194, 250, 846, 14]

[250, 195, 430, 846]
[250, 195, 430, 846, 15]

[848, 404, 252, 216]
[848, 404, 252, 216, 16]

[416, 850, 252, 207]
[416, 850, 252, 207, 17]

[216, 851, 404, 253]
[216, 851, 404, 253, 18]

[416, 257, 206, 847]
[416, 257, 206, 847, 19]

[245, 505, 845, 126]
[245, 505, 845, 126, 20]

[129, 245, 846, 503]
[129, 245, 846, 503, 21]
[122, 843, 244, 509]
[122, 843, 244, 509, 22]
[240, 121, 842, 511]
[240, 121, 842, 511, 23]
[841, 514, 241, 121]
[841, 514, 241, 121, 24]
[841, 523, 118, 246]
[841, 523, 118, 246, 25]
[121, 843, 524, 245]
[121, 843, 524, 245, 26]
[851, 116, 516, 227]
[851, 116, 516, 227, 27]
[515, 851, 117, 230]
[515, 851, 117, 230, 28]
[112, 232, 851, 547]
[112, 232, 851, 547, 29]
[112, 233, 850, 540]
[112, 233, 850, 540, 29]
[873, 210, 505, 119]
[873, 210, 505, 119, 30]
[864, 138, 234, 411]
[864, 138, 234, 411, 31]
[138, 235, 412, 863]
[138, 235, 412, 863, 32]
[396, 134, 252, 854]
[396, 134, 252, 854, 33]
[275, 836, 406, 135]
[275, 836, 406, 135, 34]
[834, 279, 405, 135]
[834, 279, 405, 135, 35]
[419, 251, 133, 855]
[419, 251, 133, 855, 36]
[136, 233, 867, 439]
[136, 233, 867, 439, 37]
[136, 866, 234, 438]
[136, 866, 234, 438, 38]
[249, 108, 529, 863]
[249, 108, 529, 863, 39]
[875, 155, 422, 231]
[875, 155, 422, 231, 40]
[232, 153, 874, 426]
[232, 153, 874, 426, 41]
[233, 874, 421, 158]
[233, 874, 421, 158, 42]
[264, 857, 121, 519]
[264, 857, 121, 519, 43]
[249, 867, 443, 150]
[249, 867, 443, 150, 44]
[136, 460, 868, 254]
[136, 460, 868, 254, 45]
[905, 332, 174, 207]
[905, 332, 174, 207, 46]
[904, 212, 168, 340]
[904, 212, 168, 340, 47]
[898, 227, 402, 138]
[898, 227, 402, 138, 48]
[369, 907, 149, 215]
[369, 907, 149, 215, 49]
[368, 907, 149, 215]
[368, 907, 149, 215, 49]
[229, 900, 141, 382]
[229, 900, 141, 382, 50]
[384, 907, 134, 230]
[384, 907, 134, 230, 51]
[233, 402, 123, 909]
[233, 402, 123, 909, 52]
[402, 287, 870, 119]
[402, 287, 870, 119, 53]
[418, 867, 116, 294]
[418, 867, 116, 294, 54]
[920, 243, 389, 119]
[920, 243, 389, 119, 55]
[921, 387, 249, 121]
[921, 387, 249, 121, 56]
[120, 375, 229, 935]
[120, 375, 229, 935, 57]
[122, 373, 229, 935]
[122, 373, 229, 935, 57]
[354, 227, 940, 119]
[354, 227, 940, 119, 58]
[360, 114, 219, 942]
[360, 114, 219, 942, 59]
[360, 218, 114, 943]
[360, 218, 114, 943, 60]
[361, 114, 219, 942]
[361, 114, 219, 942, 61]
[937, 362, 219, 113]
[937, 362, 219, 113, 62]
[345, 948, 125, 190]
[345, 948, 125, 190, 63]
[336, 138, 164, 948]
[336, 138, 164, 948, 64]
[144, 161, 947, 327]
[144, 161, 947, 327, 65]
[144, 161, 947, 327]
[144, 161, 947, 327, 65]
[944, 139, 334, 167]
[944, 139, 334, 167, 66]
[122, 219, 901, 370]
[122, 219, 901, 370, 67]
[224, 898, 122, 370]
[224, 898, 122, 370, 68]
[896, 121, 226, 372]
[896, 121, 226, 372, 69]
[121, 371, 217, 903]
[121, 371, 217, 903, 70]
[914, 363, 206, 126]
[914, 363, 206, 126, 71]
[192, 938, 347, 122]
[192, 938, 347, 122, 72]
[945, 179, 124, 341]
[945, 179, 124, 341, 73]
[945, 178, 124, 340]
[945, 178, 124, 340, 73]
[945, 177, 124, 340]
[945, 177, 124, 340, 73]
[194, 123, 940, 342]
[194, 123, 940, 342, 74]
[952, 146, 172, 319]
[952, 146, 172, 319, 75]
[956, 133, 327, 175]
[956, 133, 327, 175, 76]
[153, 963, 165, 303]
[153, 963, 165, 303, 77]
[299, 154, 164, 964]
[299, 154, 164, 964, 78]
[176, 146, 957, 318]
[176, 146, 957, 318, 79]
[961, 179, 318, 143]
[961, 179, 318, 143, 80]
[144, 178, 962, 317]
[144, 178, 962, 317, 81]
[944, 129, 331, 208]
[944, 129, 331, 208, 82]
[296, 971, 157, 175]
[296, 971, 157, 175, 83]
[296, 969, 177, 156]
[296, 969, 177, 156, 84]
[291, 156, 965, 189]
[291, 156, 965, 189, 85]
[152, 977, 177, 286]
[152, 977, 177, 286, 86]
[977, 177, 287, 151]
[977, 177, 287, 151, 87]
[288, 183, 156, 975]
[288, 183, 156, 975, 88]
[281, 162, 174, 982]
[281, 162, 174, 982, 89]
[984, 161, 282, 173]
[984, 161, 282, 173, 90]
[160, 201, 964, 287]
[160, 201, 964, 287, 91]
[223, 948, 278, 167]
[223, 948, 278, 167, 92]
[945, 226, 166, 278]
[945, 226, 166, 278, 93]
[281, 914, 268, 166]
[281, 914, 268, 166, 94]
[218, 275, 956, 167]
[218, 275, 956, 167, 95]
[212, 156, 958, 286]
[212, 156, 958, 286, 96]
[320, 307, 134, 886]
[320, 307, 134, 886, 97]
[321, 883, 132, 311]
[321, 883, 132, 311, 98]
[881, 130, 323, 313]
[881, 130, 323, 313, 99]
[318, 884, 309, 134]
[318, 884, 309, 134, 100]
[913, 301, 142, 278]
[913, 301, 142, 278, 101]
[136, 873, 309, 325]
[136, 873, 309, 325, 102]
[312, 321, 867, 132]
[312, 321, 867, 132, 103]
[880, 314, 309, 135]
[880, 314, 309, 135, 104]
[136, 881, 309, 313]
[136, 881, 309, 313, 105]

"""


